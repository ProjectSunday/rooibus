<!DOCTYPE html>
<html>
<head>
	<title>rooibus gps testing</title>
    <link rel="manifest" href="manifest.json">
</head>
<style>
	#log {
		height: 100%;
		width: 100%;
		position: absolute;
		top: 0;
		right: 0;
		left: 0;
		bottom: 0;
		background: #eee;
		font-size: 1em;
	}
</style>
<body>
<textarea id="log"></textarea>
<script type="text/javascript">

	var log = document.getElementById('log')

	// var myWorker = new Worker('myworker.js')

	// var stuff = { foo: 'stuff' }

	// var data = {
	// 	update: update
	// }

	// myWorker.postMessage('blah')


	// myWorker.addEventListener('message', function () {

	// 	navigator.geolocation.getCurrentPosition(function (loc) { 

	// 		console.log('yoooo')

	// 		var now = new Date()

	// 		var msg = now.toString()

	// 		msg += ' accuracy: ' + loc.coords.accuracy
	// 		msg += ' longitude: ' + loc.coords.longitude
	// 		msg += ' latitude: ' + loc.coords.latitude


	// 		log.value = msg + '\n' + log.value

	// 		console.log('loc')

	// 	})

//hmn

	// })



	/*
		latitude: coords.latitude,
		longitude: coords.longitude,
		lastUpdate: timestamp,
		accuracy: Math.floor(coords.accuracy)
	*/

	// setInterval(function() {

	// 	navigator.geolocation.getCurrentPosition(function (loc) { 

	// 		var now = new Date()

	// 		var msg = now.toLocaleString()

	// 		msg += ' acc: ' + loc.coords.accuracy + '\n'
	// 		msg += ' lon: ' + loc.coords.longitude
	// 		msg += ' lat: ' + loc.coords.latitude

	// 		log.value = msg + '\n' + log.value
	// 	})

	// }, 3000)




	

	navigator.geolocation.watchPosition(function(loc) {

		var now = new Date()

		var msg = '3 ' + now.toLocaleString()

		msg += ' acc: ' + loc.coords.accuracy + '\n'
		msg += ' lon: ' + loc.coords.longitude
		msg += ' lat: ' + loc.coords.latitude


		log.value = msg + '\n' + log.value

	}, undefined, { enableHighAccuracy: true })

	navigator.serviceWorker.register('./serviceworker.js')

	// navigator.serviceWorker.ready.then(function(swRegistration) {
	//   return swRegistration.sync.register('myFirstSync');
	// });

	// navigator.serviceWorker.ready.then(function(reg) {
	// 	if (reg.periodicSync) {
	// 		reg.periodicSync.register({
	// 			tag: 'periodicSync',
	// 			minPeriod: 0,
	// 			powerState: 'auto',
	// 			networkState: 'any'
	// 		}).then(function(event) {
	// 			console.log('Periodicc registration successful', event);
	// 		}).catch(function(error) {
	// 			console.log('Periodicc registration failed', error);
	// 		});
	// 	} else {
	// 		console.log("Background not supported");
	// 	}
	// });

</script>
</body>
</html>